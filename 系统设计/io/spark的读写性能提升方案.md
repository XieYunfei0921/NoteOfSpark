#### 基于非阻塞IO的改进措施

使用nio包下的输入流的时候，支持文件的异步读取，但是不支持缓存。

spark设计了`NioBufferedInputStream.java`在异步读取的时候同时支持了缓存使得读取速度进一步的上升.下面介绍它实现的方案:

#### 使用双缓冲区加速数据的读取

在第一种方案中还是会存在有缓冲区满的情况,存在这种情况下,情况缓冲区需要花费时间,这里使用双缓冲区的结构,当缓冲区满的时候只需要切换缓冲区即可.

+ 在这里用于异步读取数据的缓冲区叫做**预读缓冲区**.
+ 用于给系统消费的数据缓冲区叫做**活动缓冲区**

#### 用于传输的加密算法

+ snappy压缩

  > **介绍**:
  >
  > **Snappy**（以前称**Zippy**）是Google基于LZ77与LZ78的思路用C++语言编写的快速数据压缩与解压程序库.它的目标并非最大压缩率或与其他压缩程序库的兼容性，而是非常高的速度和合理的压缩率.使用一个运行在64位模式下的酷睿i7处理器的单个核心，压缩速度250 MB/s，解压速度500 MB/s。压缩率比gzip低20-100%.

+ lz4压缩

  > **介绍**:
  >
  > **LZ4**是一种**无损数据压缩**算法，着重于**压缩和解压缩速度**。它属于面向字节的LZ77压缩方案家族。该算法提供一个比LZO算法稍差的压缩率——这逊于gzip等算法。但是，它的压缩速度类似LZO——比gzip快几倍；而解压速度显著快于LZO.

+ ZStd压缩

  > **介绍:**
  >
  > **Zstandard**（或**Zstd**）是由Facebook的Yann Collet开发的一个**无损数据压缩**算法.Zstandard在设计上与zip,gzip算法有着差不多的压缩比，但有更高的压缩和解压缩速度。

**lz4算法原理**

各类压缩算法的性能对比:

| Format  | Size Before(byte) | Size After(byte) | Compress Expend(ms) | UnCompress Expend(ms) | MAX CPU(%) |
| ------- | ----------------- | ---------------- | ------------------- | --------------------- | ---------- |
| bzip2   | 35984             | 8677             | 11591               | 2362                  | 29.5       |
| gzip    | 35984             | 8804             | 2179                | 389                   | 26.5       |
| deflate | 35984             | 9704             | 680                 | 344                   | 20.5       |
| lzo     | 35984             | 13069            | 581                 | 230                   | 22         |
| lz4     | 35984             | 16355            | 327                 | 147                   | 12.6       |
| snappy  | 35984             | 13602            | 424                 | 88                    | 11         |

